{% extends "layout.html" %}
{% block content %}

<h1 class="page-title">Administration SSIAP</h1>

<div class="admin-container">

    <!-- ===========================================
         TABLEAU DES CANDIDATS
    ============================================ -->
    <h2>Candidats inscrits</h2>

    {% if data.candidats|length == 0 %}
        <p>Aucun candidat pour le moment.</p>
    {% else %}
    <div class="table-wrapper">
        <table class="admin-table">
            <thead>
                <tr>
                    <th>Nom</th>
                    <th>Pr√©nom</th>
                    <th>Email</th>
                    <th>T√©l√©phone</th>
                    <th>Date</th>
                    <th>Documents</th>
                    <th>Statut</th>
                    <th>Commentaire</th>
                    <th>Suppr.</th>
                </tr>
            </thead>
            <tbody>

                {% for c in data.candidats %}
                <tr data-id="{{ c.id }}">
                    <td>{{ c.nom }}</td>
                    <td>{{ c.prenom }}</td>
                    <td>{{ c.email }}</td>
                    <td>{{ c.telephone }}</td>
                    <td>{{ c.date_inscription }}</td>

                    <td>
                        {% if c.fichiers.identite %}
                            <a href="/uploads/{{ c.fichiers.identite }}" target="_blank">Identit√©</a><br>
                        {% endif %}

                        {% if c.fichiers.certificat %}
                            <a href="/uploads/{{ c.fichiers.certificat }}" target="_blank">Certificat</a><br>
                        {% endif %}

                        {% if c.fichiers.test_francais %}
                            <a href="/uploads/{{ c.fichiers.test_francais }}" target="_blank">Test FR</a><br>
                        {% endif %}

                        {% if c.fichiers.photo %}
                            <a href="/uploads/{{ c.fichiers.photo }}" target="_blank">Photo</a><br>
                        {% endif %}
                    </td>

                    <td>
                        <select class="select-statut" data-field="statut">
                            <option value="en_attente" {% if c.statut == "en_attente" %}selected{% endif %}>En attente</option>
                            <option value="complet" {% if c.statut == "complet" %}selected{% endif %}>Complet</option>
                            <option value="incomplet" {% if c.statut == "incomplet" %}selected{% endif %}>Incomplet</option>
                        </select>
                    </td>

                    <td contenteditable="true" data-field="commentaire">{{ c.commentaire }}</td>

                    <td>
                        <a class="delete-btn" href="/admin/delete/{{ c.id }}" onclick="return confirm('Supprimer ce candidat ?')">üóëÔ∏è</a>
                    </td>
                </tr>
                {% endfor %}

            </tbody>
        </table>
    </div>
    {% endif %}



    <!-- ===========================================
         BLOC CONFORMIT√â ARR√äT√â DU 2 MAI 2005
    ============================================ -->
    <h2>Conformit√© - Arr√™t√© du 2 mai 2005</h2>

    <div class="conformite-wrapper">

        {% set conf = data.conformite %}

        <table class="conformite-table">
            <thead>
                <tr>
                    <th>Exigence r√©glementaire</th>
                    <th>Statut</th>
                </tr>
            </thead>

            <tbody>

                <!-- Pr√©fecture avis√©e -->
                <tr>
                    <td>Pr√©fecture avis√©e 2 mois avant</td>
                    <td>
                        <div class="conf-btns" data-champ="prefecture_avis">
                            <button class="conf-btn {% if conf.prefecture_avis=='conforme' %}green{% endif %}" data-value="conforme">Conforme</button>
                            <button class="conf-btn {% if conf.prefecture_avis=='a_venir' %}orange{% endif %}" data-value="a_venir">√Ä venir</button>
                            <button class="conf-btn {% if conf.prefecture_avis=='non_conforme' %}red{% endif %}" data-value="non_conforme">Non conforme</button>
                        </div>
                    </td>
                </tr>

                <!-- Test de fran√ßais -->
                <tr>
                    <td>Test de fran√ßais valid√© pour tous les candidats</td>
                    <td>
                        <div class="conf-btns" data-champ="test_francais">
                            <button class="conf-btn {% if conf.test_francais=='conforme' %}green{% endif %}" data-value="conforme">Conforme</button>
                            <button class="conf-btn {% if conf.test_francais=='a_venir' %}orange{% endif %}" data-value="a_venir">√Ä venir</button>
                            <button class="conf-btn {% if conf.test_francais=='non_conforme' %}red{% endif %}" data-value="non_conforme">Non conforme</button>
                        </div>
                    </td>
                </tr>

                <!-- Certificats m√©dicaux -->
                <tr>
                    <td>Certificats m√©dicaux collect√©s</td>
                    <td>
                        <div class="conf-btns" data-champ="certificats_medicaux">
                            <button class="conf-btn {% if conf.certificats_medicaux=='conforme' %}green{% endif %}" data-value="conforme">Conforme</button>
                            <button class="conf-btn {% if conf.certificats_medicaux=='a_venir' %}orange{% endif %}" data-value="a_venir">√Ä venir</button>
                            <button class="conf-btn {% if conf.certificats_medicaux=='non_conforme' %}red{% endif %}" data-value="non_conforme">Non conforme</button>
                        </div>
                    </td>
                </tr>

                <!-- Identit√©s -->
                <tr>
                    <td>Pi√®ces d'identit√© fournies par tous</td>
                    <td>
                        <div class="conf-btns" data-champ="identites">
                            <button class="conf-btn {% if conf.identites=='conforme' %}green{% endif %}" data-value="conforme">Conforme</button>
                            <button class="conf-btn {% if conf.identites=='a_venir' %}orange{% endif %}" data-value="a_venir">√Ä venir</button>
                            <button class="conf-btn {% if conf.identites=='non_conforme' %}red{% endif %}" data-value="non_conforme">Non conforme</button>
                        </div>
                    </td>
                </tr>

                <!-- Locaux -->
                <tr>
                    <td>Locaux et mat√©riel conformes</td>
                    <td>
                        <div class="conf-btns" data-champ="locaux">
                            <button class="conf-btn {% if conf.locaux=='conforme' %}green{% endif %}" data-value="conforme">Conforme</button>
                            <button class="conf-btn {% if conf.locaux=='a_venir' %}orange{% endif %}" data-value="a_venir">√Ä venir</button>
                            <button class="conf-btn {% if conf.locaux=='non_conforme' %}red{% endif %}" data-value="non_conforme">Non conforme</button>
                        </div>
                    </td>
                </tr>

                <!-- Formateurs -->
                <tr>
                    <td>Formateurs d√©clar√©s √† la pr√©fecture</td>
                    <td>
                        <div class="conf-btns" data-champ="formateurs">
                            <button class="conf-btn {% if conf.formateurs=='conforme' %}green{% endif %}" data-value="conforme">Conforme</button>
                            <button class="conf-btn {% if conf.formateurs=='a_venir' %}orange{% endif %}" data-value="a_venir">√Ä venir</button>
                            <button class="conf-btn {% if conf.formateurs=='non_conforme' %}red{% endif %}" data-value="non_conforme">Non conforme</button>
                        </div>
                    </td>
                </tr>

                <!-- Planning -->
                <tr>
                    <td>Planning et feuilles d'√©margement pr√™ts</td>
                    <td>
                        <div class="conf-btns" data-champ="planning">
                            <button class="conf-btn {% if conf.planning=='conforme' %}green{% endif %}" data-value="conforme">Conforme</button>
                            <button class="conf-btn {% if conf.planning=='a_venir' %}orange{% endif %}" data-value="a_venir">√Ä venir</button>
                            <button class="conf-btn {% if conf.planning=='non_conforme' %}red{% endif %}" data-value="non_conforme">Non conforme</button>
                        </div>
                    </td>
                </tr>

            </tbody>
        </table>
    </div>

</div>

{% endblock %}
